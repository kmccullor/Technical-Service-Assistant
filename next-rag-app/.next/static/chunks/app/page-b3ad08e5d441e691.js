(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6549:function(e,t,s){Promise.resolve().then(s.bind(s,6191))},6191:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return eu}});var a=s(7437),r=s(2265),n=s(9376),o=s(1245),i=s(8867),l=s(129),c=s(8736),d=s(9202),u=s(3247),m=s(7689),x=s(1817),h=s(9322),p=s(1671),f=s(2489),v=s(4440),g=s(7416),j=s(6980),y=s(4743),N=s(2869),b=s(4508);let w=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,b.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});w.displayName="Textarea";var S=s(6070),C=s(5974),k=s(962);let D=k.fC,_=k.wy,z=k.Fw;async function A(e){if(navigator.clipboard)await navigator.clipboard.writeText(e);else{let t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}}let E=[".txt",".log",".csv",".json",".sql",".pdf",".xml",".conf",".config",".ini",".properties",".out",".err",".trace",".dump",".png",".jpg",".jpeg",".gif",".bmp",".tiff",".webp"];function R(e){let{conversationId:t,onConversationCreated:s,onConversationActivity:n}=e,{accessToken:b}=(0,o.a)(),[k,R]=(0,r.useState)([]),[Z,T]=(0,r.useState)(""),[L,F]=(0,r.useState)(!1),[I,P]=(0,r.useState)(null),[O,U]=(0,r.useState)(!1),[B,M]=(0,r.useState)(null),[V,q]=(0,r.useState)(!1),[Y,G]=(0,r.useState)(!1),H=(0,r.useRef)(null),K=(0,r.useRef)(null),J=(0,r.useRef)(null),W=()=>{var e;null===(e=H.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,r.useEffect)(()=>{W()},[k]);let[$,Q]=(0,r.useState)(!1),[X,ee]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=!1,s=async t=>{if(!b){ee("Authentication required to load conversation."),R([]);return}try{Q(!0),ee(null);let s=await fetch("/api/conversations/".concat(t),{headers:{Authorization:"Bearer ".concat(b)},cache:"no-store"});if(!s.ok){if(404===s.status){ee("Conversation not found."),R([]);return}let e=await s.text().catch(()=>"");throw Error(e||"Failed to load conversation (status ".concat(s.status,")"))}let a=await s.json();if(e)return;let r=Array.isArray(null==a?void 0:a.messages)?a.messages.map(e=>{var t,s,a,r;return{id:String(e.id),role:"assistant"===e.role?"assistant":"user",content:null!==(t=e.content)&&void 0!==t?t:"",citations:Array.isArray(e.citations)?e.citations:void 0,searchType:null!==(s=e.searchType)&&void 0!==s?s:e.method,timestamp:new Date(null!==(r=null!==(a=e.createdAt)&&void 0!==a?a:e.created_at)&&void 0!==r?r:new Date().toISOString())}}):[];R(r),P(null),M(null)}catch(t){e||(console.error("Failed to load conversation history:",t),ee("Unable to load conversation history."),R([]))}finally{e||Q(!1)}};return void 0===t?(R([]),T(""),P(null),M(null),ee(null),Q(!1)):s(t),()=>{e=!0}},[t,b]);let et=e=>{if(e.size>10485760)return"File size exceeds ".concat(10,"MB limit");let t=e.name.toLowerCase().substring(e.name.lastIndexOf("."));return E.includes(t)?null:"File type not supported. Allowed: ".concat(E.join(", "))},es=async e=>{let t=et(e);if(t){M(t);return}U(!0),M(null);try{let t=new FormData;t.append("file",e);let s=await fetch("/api/temp-upload",{method:"POST",body:t,headers:b?{Authorization:"Bearer ".concat(b)}:void 0}),a=await s.json();if(!a.success)throw Error(a.error||"Upload failed");let r={sessionId:a.sessionId,fileName:a.fileName,fileSize:a.fileSize,uploadTime:new Date().toISOString()};P(r);let n={id:Date.now().toString(),role:"assistant",content:"✅ **File uploaded successfully:** ".concat(e.name," (").concat(ea(e.size),")\n\nYou can now ask questions about this document. I'll analyze its content to provide specific insights and troubleshooting assistance."),searchType:"temp-doc",uploadedFile:r,timestamp:new Date};R(e=>[...e,n])}catch(e){console.error("Upload error:",e),M(e instanceof Error?e.message:"Upload failed")}finally{U(!1)}},ea=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["Bytes","KB","MB"][t]},[er,en]=(0,r.useState)(!1),[eo,ei]=(0,r.useState)("");(0,r.useEffect)(()=>{let e=e=>{var t;(null===(t=e.dataTransfer)||void 0===t?void 0:t.types.includes("Files"))&&q(!0)},t=e=>{0===e.clientX&&0===e.clientY&&q(!1)};return document.addEventListener("dragenter",e),document.addEventListener("dragleave",t),()=>{document.removeEventListener("dragenter",e),document.removeEventListener("dragleave",t)}},[]);let el=async e=>{e.preventDefault();let a=Z.trim();if(!a||L)return;if(!b){ei("Please sign in to chat."),en(!0);return}let r=a.match(/^\/(new|update|close)\s+case\s+(.+)$/i),o=a,i=a;if(r){let e=r[1].toLowerCase(),t=r[2].trim();if(!t){ei("Please provide a case number, e.g. /new case 01125052"),en(!0);return}"new"===e?(o="\uD83D\uDCC4 Initiating Salesforce case ".concat(t),i="You are assisting with Salesforce case ".concat(t,". Using the conversation context, define the case for analysis and recommendation by providing:\n- A concise case overview with important facts known so far.\n- Immediate diagnostic or triage steps to perform.\n- Clarifying questions that should be asked of the customer.\n- Recommended next actions for engineering/support teams.\nReturn the response with headings: Case Overview, Immediate Actions, Clarifying Questions, Recommended Next Steps.")):"update"===e?(o="\uD83D\uDEE0️ Updating Salesforce case ".concat(t),i="You are providing an update on Salesforce case ".concat(t,". Review the conversation context and produce:\n- The current status/progress of the case.\n- Outstanding issues or blockers.\n- Recommended next steps for the support engineer.\n- Suggested customer communication points.\nReturn the response with headings: Case Status, Outstanding Items, Recommended Actions, Customer Communication.")):"close"===e&&(o="✅ Closing Salesforce case ".concat(t),i="You are preparing to close Salesforce case ".concat(t,". Based on the conversation context, provide:\n- A brief incident summary.\n- Actions taken and resolutions applied.\n- Verification steps or final checks completed/needed.\n- Final closing comments for the customer.\nReturn the response with headings: Summary, Actions Taken, Verification, Closing Comments."))}let l={id:Date.now().toString(),role:"user",content:o,uploadedFile:I||void 0,timestamp:new Date};R(e=>[...e,l]);let c=i;T(""),F(!0);try{var d,u;if(I){let e=await fetch("/api/temp-analyze",{method:"POST",headers:{"Content-Type":"application/json",...b?{Authorization:"Bearer ".concat(b)}:{}},body:JSON.stringify({sessionId:I.sessionId,query:c,maxResults:5})});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json(),s={id:(Date.now()+1).toString(),role:"assistant",content:t.response,citations:null===(u=t.results)||void 0===u?void 0:u.map((e,t)=>({id:"temp-".concat(t),title:"Section ".concat(e.rank),content:e.content,source:I.fileName,score:e.similarity})),searchType:"temp-doc",timestamp:new Date};R(e=>[...e,s]);return}let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(b)},body:JSON.stringify({conversationId:t,message:c,displayMessage:l.content})});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let a=null===(d=e.body)||void 0===d?void 0:d.getReader();if(!a)throw Error("No response body");let r={id:(Date.now()+1).toString(),role:"assistant",content:"",timestamp:new Date},o=t;for(R(e=>[...e,r]);;){let{done:e,value:n}=await a.read();if(e)break;for(let e of new TextDecoder().decode(n).split("\n"))if(e.startsWith("data: "))try{let a=JSON.parse(e.slice(6));"token"===a.type?R(e=>e.map(e=>e.id===r.id?{...e,content:e.content+a.token}:e)):"sources"===a.type?R(e=>e.map(e=>e.id===r.id?{...e,citations:a.sources,searchType:a.method}:e)):"conversation_id"===a.type?"number"==typeof a.conversationId&&(o=a.conversationId,void 0===t&&(null==s||s(a.conversationId))):"done"===a.type?console.log("Streaming completed"):"error"===a.type&&console.error("Streaming error:",a.error)}catch(t){console.warn("Failed to parse streaming data:",e)}}void 0!==o&&(null==n||n(o))}catch(t){console.error("Chat error:",t);let e={id:(Date.now()+1).toString(),role:"assistant",content:"Sorry, I encountered an error. Please try again.",timestamp:new Date};R(t=>[...t,e])}finally{F(!1)}},ec=e=>{switch(e){case"documents":return(0,a.jsx)(c.Z,{className:"h-3 w-3"});case"web":return(0,a.jsx)(d.Z,{className:"h-3 w-3"});case"hybrid":default:return(0,a.jsx)(u.Z,{className:"h-3 w-3"});case"temp-doc":return(0,a.jsx)(m.Z,{className:"h-3 w-3"})}},ed=e=>{switch(e){case"documents":return"Document Search";case"web":return"Web Search";case"hybrid":return"Hybrid Search";case"temp-doc":return"Uploaded Document";default:return"Search"}};return(0,a.jsxs)("div",{ref:J,className:"flex flex-col h-full relative",onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),q(!0)},onDragLeave:e=>{var t;e.preventDefault(),e.stopPropagation(),(null===(t=J.current)||void 0===t?void 0:t.contains(e.relatedTarget))||q(!1)},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation(),q(!1);let t=e.dataTransfer.files;t&&t.length>0&&es(t[0])},children:[V&&(0,a.jsx)("div",{className:"absolute inset-0 z-50 bg-blue-500/10 backdrop-blur-sm flex items-center justify-center border-2 border-dashed border-blue-500",children:(0,a.jsxs)("div",{className:"text-center p-8 bg-white/90 rounded-lg shadow-lg",children:[(0,a.jsx)(m.Z,{className:"h-12 w-12 mx-auto text-blue-500 mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-blue-900 mb-2",children:"Drop file to analyze"}),(0,a.jsx)("p",{className:"text-blue-700",children:"Supports logs, configs, PDFs, images, and more"}),(0,a.jsx)("p",{className:"text-sm text-blue-600 mt-2",children:"AI will analyze your document with Technical Service Assistant expertise"})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[$&&0===k.length?(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-8",children:[(0,a.jsx)(x.Z,{className:"h-10 w-10 mx-auto mb-4 animate-spin"}),(0,a.jsx)("p",{children:"Loading conversation..."})]}):X&&0===k.length?(0,a.jsxs)("div",{className:"text-center text-red-500 py-8",children:[(0,a.jsx)(h.Z,{className:"h-10 w-10 mx-auto mb-4"}),(0,a.jsx)("p",{children:X})]}):0===k.length?(0,a.jsxs)("div",{className:"text-center text-muted-foreground py-8",children:[(0,a.jsx)(u.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Start a conversation"}),(0,a.jsx)("p",{children:"Ask questions about your documents or any topic."})]}):null,k.map(e=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-[80%] ".concat("user"===e.role?"bg-primary text-primary-foreground":"bg-muted"," rounded-lg p-4 relative"),children:[(0,a.jsx)("div",{className:"whitespace-pre-wrap break-words",children:e.content}),"assistant"===e.role&&(0,a.jsx)("button",{className:"absolute top-2 right-2 p-1 rounded hover:bg-accent focus:outline-none focus:ring",title:"Copy response","aria-label":"Copy response","data-testid":"copy-btn",onClick:async()=>{try{await A(function(e){let t=e.content;if(e.citations&&e.citations.length>0)for(let s of(t+="\n\nSources:",e.citations))t+="\n- ".concat(s.title," (").concat(s.source,")").concat(s.score?" [".concat((100*s.score).toFixed(0),"% match]"):"");return t+="\n\nTimestamp: ".concat(e.timestamp.toLocaleString())}(e)),ei("Copied to clipboard!"),en(!0)}catch(e){ei("Copy failed"),en(!0)}},children:(0,a.jsx)(i.Z,{className:"h-4 w-4 text-muted-foreground"})}),e.citations&&e.citations.length>0&&(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t border-border/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[ec(e.searchType),(0,a.jsx)("span",{className:"text-xs font-medium",children:ed(e.searchType)}),(0,a.jsxs)(C.C,{variant:"secondary",className:"text-xs",children:[e.citations.length," source",1!==e.citations.length?"s":""]})]}),(0,a.jsxs)(D,{children:[(0,a.jsx)(_,{className:"text-xs text-muted-foreground hover:text-foreground transition-colors",children:"Show sources ↓"}),(0,a.jsx)(z,{className:"mt-2 space-y-2",children:e.citations.map((e,t)=>(0,a.jsx)(S.Zb,{className:"text-xs",children:(0,a.jsxs)(S.aY,{className:"p-3",children:[(0,a.jsx)("div",{className:"font-medium mb-1",children:e.title}),(0,a.jsx)("div",{className:"text-muted-foreground mb-2 line-clamp-2",children:e.content}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:e.source}),e.score&&(0,a.jsxs)(C.C,{variant:"outline",children:[(100*e.score).toFixed(0),"% match"]})]})]})},t))})]})]})]})},e.id)),$&&k.length>0&&(0,a.jsx)("div",{className:"text-center text-xs text-muted-foreground",children:"Updating conversation…"}),L&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-muted rounded-lg p-4",children:(0,a.jsx)(x.Z,{className:"h-4 w-4 animate-spin"})})}),(0,a.jsx)("div",{ref:H})]}),(0,a.jsxs)("div",{className:"sticky bottom-0 border-t bg-background p-4 z-10",children:[I&&(0,a.jsxs)("div",{className:"mb-3 p-3 bg-green-50 border border-green-200 rounded-lg flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 text-green-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-green-900",children:I.fileName}),(0,a.jsxs)("span",{className:"text-sm text-green-600 ml-2",children:["(",ea(I.fileSize),")"]})]})]}),(0,a.jsx)(N.z,{variant:"ghost",size:"sm",onClick:()=>{P(null),M(null),K.current&&(K.current.value="")},className:"text-green-700 hover:text-green-800",children:(0,a.jsx)(f.Z,{className:"h-4 w-4"})})]}),B&&(0,a.jsxs)("div",{className:"mb-3 p-3 bg-red-50 border border-red-200 rounded-lg flex items-start gap-2",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 text-red-500 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-red-900",children:"Upload Error"}),(0,a.jsx)("div",{className:"text-sm text-red-600",children:B})]}),(0,a.jsx)(N.z,{variant:"ghost",size:"sm",onClick:()=>M(null),className:"text-red-700 hover:text-red-800 ml-auto",children:(0,a.jsx)(f.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("form",{onSubmit:el,className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,a.jsx)("span",{children:"Press Enter to send, Shift+Enter for a new line."}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(N.z,{type:"button",variant:"ghost",size:"icon",onClick:()=>G(e=>!e),className:"text-muted-foreground hover:text-foreground",title:Y?"Collapse input":"Expand input",children:Y?(0,a.jsx)(v.Z,{className:"h-4 w-4"}):(0,a.jsx)(g.Z,{className:"h-4 w-4"})})})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(w,{value:Z,onChange:e=>T(e.target.value),placeholder:I?I.fileName.match(/\.(png|jpg|jpeg|gif|bmp|tiff|webp)$/i)?"Describe what you see in the image or ask questions about it...":"Ask questions about the uploaded document...":"Ask a question about your documents...",className:"w-full pr-12 resize-y ".concat(Y?"min-h-[180px]":"min-h-[80px]"," max-h-[320px]"),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),el(e))}}),(0,a.jsxs)("div",{className:"absolute right-3 bottom-3 flex items-center gap-2",children:[(0,a.jsx)("input",{type:"file",ref:K,onChange:e=>{let t=e.target.files;t&&t.length>0&&es(t[0])},accept:E.join(","),className:"hidden"}),(0,a.jsx)(N.z,{type:"button",variant:"ghost",size:"icon",onClick:()=>{var e;return null===(e=K.current)||void 0===e?void 0:e.click()},disabled:O,className:"h-7 w-7",title:"Upload document for analysis",children:O?(0,a.jsx)(x.Z,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(j.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:!I&&"\uD83D\uDCA1 Tip: Click the clip icon or drag & drop files to upload logs, configs, images, or other documents."}),(0,a.jsx)(N.z,{type:"submit",disabled:!Z.trim()||L,children:L?(0,a.jsx)(x.Z,{className:"h-4 w-4 animate-spin"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{className:"h-4 w-4 mr-1"})," Send"]})})]})]}),!I&&(0,a.jsx)("div",{className:"mt-2 text-xs text-muted-foreground",children:"Need to describe a longer issue? Expand the input or attach files for deeper analysis."})]}),(0,a.jsxs)(l.zt,{swipeDirection:"right",children:[(0,a.jsx)(l.fC,{open:er,onOpenChange:en,duration:2e3,className:"bg-black text-white px-4 py-2 rounded shadow-lg",children:(0,a.jsx)(l.Dx,{children:eo})}),(0,a.jsx)(l.l_,{className:"fixed bottom-4 right-4 z-50"})]})]})}var Z=s(7648),T=s(8728),L=s(9397),F=s(2718),I=s(8930),P=s(166);let O=(0,P.default)(()=>s.e(110).then(s.bind(s,6110)).then(e=>({default:e.Dialog})),{loadableGenerated:{webpack:()=>[6110]},ssr:!1,loading:()=>null}),U=(0,P.default)(()=>s.e(110).then(s.bind(s,6110)).then(e=>({default:e.DialogContent})),{loadableGenerated:{webpack:()=>[6110]},ssr:!1,loading:()=>null}),B=(0,P.default)(()=>s.e(110).then(s.bind(s,6110)).then(e=>({default:e.DialogHeader})),{loadableGenerated:{webpack:()=>[6110]},ssr:!1,loading:()=>null}),M=(0,P.default)(()=>s.e(110).then(s.bind(s,6110)).then(e=>({default:e.DialogTitle})),{loadableGenerated:{webpack:()=>[6110]},ssr:!1,loading:()=>null}),V=(0,P.default)(()=>s.e(110).then(s.bind(s,6110)).then(e=>({default:e.DialogTrigger})),{loadableGenerated:{webpack:()=>[6110]},ssr:!1,loading:()=>null}),q=(0,P.default)(()=>s.e(110).then(s.bind(s,6110)).then(e=>({default:e.DialogDescription})),{loadableGenerated:{webpack:()=>[6110]},ssr:!1,loading:()=>null});var Y=s(2672);function G(e){let{onNewChat:t,onSelectConversation:s,currentConversationId:n,refreshKey:i=0,onConversationDeleted:l}=e,[d,u]=(0,r.useState)(!1),[m,x]=(0,r.useState)([]),[h,p]=(0,r.useState)(!1),[f,v]=(0,r.useState)({documents:0,chunks:0}),[g,j]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),[w,S]=(0,r.useState)([]),[C,k]=(0,r.useState)([]),[D,_]=(0,r.useState)(!1),[z,A]=(0,r.useState)(null),[E,R]=(0,r.useState)(null),[Z,P]=(0,r.useState)(""),[G,H]=(0,r.useState)(new Set),[K,J]=(0,r.useState)(!1),[W,$]=(0,r.useState)(!1),[Q,X]=(0,r.useState)({type:[],product:[],version:[],privacy:[]}),[ee,et]=(0,r.useState)({types:[],products:[],versions:[],privacies:[]}),{accessToken:es,user:ea}=(0,o.a)(),er="admin"===((null==ea?void 0:ea.role_name)||"").toLowerCase();(0,r.useEffect)(()=>{u(!0)},[]);let en=(0,r.useCallback)(async()=>{if(!es){x([]);return}try{p(!0);let e=await fetch("/api/conversations?limit=30",{headers:{Authorization:"Bearer ".concat(es)},cache:"no-store"});if(!e.ok){if(401===e.status){x([]);return}let t="";try{let s=await e.json();t=(null==s?void 0:s.error)||(null==s?void 0:s.detail)||""}catch(e){}throw Error(t||"Failed to load conversations (status ".concat(e.status,")"))}let t=await e.json();if(!Array.isArray(t)){x([]);return}let s=t.map(e=>{var t,s,a,r,n,o,i;return{id:e.id,title:null!==(t=e.title)&&void 0!==t?t:"Untitled conversation",createdAt:null!==(a=null!==(s=e.createdAt)&&void 0!==s?s:e.created_at)&&void 0!==a?a:null,updatedAt:null!==(n=null!==(r=e.updatedAt)&&void 0!==r?r:e.updated_at)&&void 0!==n?n:null,lastReviewedAt:null!==(i=null!==(o=e.lastReviewedAt)&&void 0!==o?o:e.last_reviewed_at)&&void 0!==i?i:null}});x(s)}catch(e){console.error("[Conversations] fetch error:",e),x([])}finally{p(!1)}},[es]);(0,r.useEffect)(()=>{v({documents:42,chunks:1234})},[]),(0,r.useEffect)(()=>{en()},[en,i]),(0,r.useEffect)(()=>{if(!y)return;if(!es){S([]),k([]),A("Not authenticated");return}let e=!1;return _(!0),A(null),R(null),(async()=>{try{let t=await (0,Y.ju)({accessToken:es,limit:50,offset:0});if(e)return;let s=Array.isArray(null==t?void 0:t.documents)?t.documents:[];S(s)}catch(t){if(e)return;console.error("[Documents] fetch error:",t),S([]),k([]),A((null==t?void 0:t.message)||"Failed to load documents")}finally{e||_(!1)}})(),()=>{e=!0}},[y,es]),(0,r.useEffect)(()=>{if(!y)return;let e={types:new Set,products:new Set,versions:new Set,privacies:new Set};w.forEach(t=>{t.document_type&&e.types.add(t.document_type),t.product_name&&e.products.add(t.product_name),t.product_version&&e.versions.add(t.product_version),t.privacy_level&&e.privacies.add(t.privacy_level)}),et({types:Array.from(e.types).sort(),products:Array.from(e.products).sort(),versions:Array.from(e.versions).sort(),privacies:Array.from(e.privacies).sort()}),X(t=>({type:t.type.filter(t=>e.types.has(t)),product:t.product.filter(t=>e.products.has(t)),version:t.version.filter(t=>e.versions.has(t)),privacy:t.privacy.filter(t=>e.privacies.has(t))}))},[y,w]),(0,r.useEffect)(()=>{if(!y)return;let e=Z.trim().toLowerCase();k(w.filter(t=>{let s=[t.file_name,t.document_type,t.product_name,t.product_version,t.privacy_level].filter(e=>"string"==typeof e&&e.length>0).map(e=>e.toLowerCase());return!!((!e||s.some(t=>t.includes(e)))&&(!Q.type.length||t.document_type&&Q.type.includes(t.document_type))&&(!Q.product.length||t.product_name&&Q.product.includes(t.product_name))&&(!Q.version.length||t.product_version&&Q.version.includes(t.product_version))&&(!Q.privacy.length||t.privacy_level&&Q.privacy.includes(t.privacy_level)))}))},[Z,w,y,Q]),(0,r.useEffect)(()=>{y||(P(""),X({type:[],product:[],version:[],privacy:[]}),H(new Set),R(null))},[y]),(0,r.useEffect)(()=>{H(e=>{if(0===e.size)return e;let t=new Set(w.map(e=>e.id)),s=!1,a=new Set;return e.forEach(e=>{t.has(e)?a.add(e):s=!0}),s?a:e})},[w]);let eo=(e,t)=>{X(s=>{let a=new Set(s[e]);return a.has(t)?a.delete(t):a.add(t),{...s,[e]:Array.from(a)}})},ei=e=>{H(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},el=async()=>{if(es&&0!==G.size){J(!0),R(null);try{for(let e of Array.from(G)){let t=w.find(t=>t.id===e);if(!t)continue;let s=await (0,Y.AG)(es,e),a=window.URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download=t.file_name||"document-".concat(e),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a)}}catch(e){console.error("[Documents] bulk download error:",e),R((null==e?void 0:e.message)||"Failed to download selected documents")}finally{J(!1)}}},ec=async()=>{if(!er||!es||0===G.size)return;let e=Array.from(G);if(window.confirm("Delete ".concat(e.length," document").concat(e.length>1?"s":"","? This action cannot be undone."))){$(!0),R(null);try{for(let t of e)await (0,Y.iH)(es,t);let t=new Set(e);S(e=>e.filter(e=>!t.has(e.id))),H(new Set)}catch(e){console.error("[Documents] bulk delete error:",e),R((null==e?void 0:e.message)||"Failed to delete selected documents")}finally{$(!1)}}},ed=G.size,eu=(0,r.useMemo)(()=>0!==C.length&&C.every(e=>G.has(e.id)),[C,G]);return d?(0,a.jsxs)("div",{className:"w-64 bg-muted/30 border-r flex flex-col",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)(O,{open:y,onOpenChange:b,children:[(0,a.jsx)(V,{asChild:!0,children:(0,a.jsxs)(N.z,{variant:"ghost",className:"w-full justify-start",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Documents"]})}),(0,a.jsxs)(U,{className:"sm:max-w-md",children:[(0,a.jsxs)(B,{children:[(0,a.jsx)(M,{children:"Documents"}),(0,a.jsx)(q,{children:"View and manage uploaded documents."})]}),D?(0,a.jsx)("div",{className:"py-2 text-muted-foreground text-sm",children:"Loading documents..."}):z?(0,a.jsxs)("div",{className:"py-2 text-red-500 text-sm",children:["Error: ",z]}):(0,a.jsxs)("div",{className:"py-2 space-y-2",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("input",{type:"text",value:Z,onChange:e=>P(e.target.value),placeholder:"Search documents",className:"w-full border rounded px-2 py-1 text-sm"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsxs)("div",{className:"border rounded px-2 py-2",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"Type"}),(0,a.jsx)("div",{className:"flex flex-col gap-1 max-h-24 overflow-y-auto pr-1",children:0===ee.types.length?(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"No types available"}):ee.types.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)("input",{type:"checkbox",checked:Q.type.includes(e),onChange:()=>eo("type",e),className:"h-3 w-3"}),(0,a.jsx)("span",{children:e})]},e))})]}),(0,a.jsxs)("div",{className:"border rounded px-2 py-2",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"Product"}),(0,a.jsx)("div",{className:"flex flex-col gap-1 max-h-24 overflow-y-auto pr-1",children:0===ee.products.length?(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"No products available"}):ee.products.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)("input",{type:"checkbox",checked:Q.product.includes(e),onChange:()=>eo("product",e),className:"h-3 w-3"}),(0,a.jsx)("span",{children:e})]},e))})]}),(0,a.jsxs)("div",{className:"border rounded px-2 py-2",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"Version"}),(0,a.jsx)("div",{className:"flex flex-col gap-1 max-h-24 overflow-y-auto pr-1",children:0===ee.versions.length?(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"No versions available"}):ee.versions.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)("input",{type:"checkbox",checked:Q.version.includes(e),onChange:()=>eo("version",e),className:"h-3 w-3"}),(0,a.jsx)("span",{children:e})]},e))})]}),(0,a.jsxs)("div",{className:"border rounded px-2 py-2",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-muted-foreground mb-1",children:"Privacy"}),(0,a.jsx)("div",{className:"flex flex-col gap-1 max-h-24 overflow-y-auto pr-1",children:0===ee.privacies.length?(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"No privacy levels available"}):ee.privacies.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)("input",{type:"checkbox",checked:Q.privacy.includes(e),onChange:()=>eo("privacy",e),className:"h-3 w-3"}),(0,a.jsx)("span",{children:e})]},e))})]})]})]}),E&&(0,a.jsx)("div",{className:"text-xs text-red-500 px-1",children:E}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground px-1",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"h-3 w-3",checked:eu,onChange:()=>{H(e=>{let t=new Set(e);return C.length>0&&C.every(e=>t.has(e.id))?C.forEach(e=>t.delete(e.id)):C.forEach(e=>t.add(e.id)),t})},disabled:0===C.length}),(0,a.jsx)("span",{children:"Select all"})]}),(0,a.jsxs)("span",{children:[ed," selected"]})]}),(0,a.jsxs)("div",{className:"flex gap-2 px-1",children:[(0,a.jsx)(N.z,{size:"sm",variant:"outline",className:"flex-1",onClick:el,disabled:0===ed||K,children:K?"Downloading...":"Download Selected"}),er&&(0,a.jsx)(N.z,{size:"sm",variant:"destructive",className:"flex-1",onClick:ec,disabled:0===ed||W,children:W?"Deleting...":"Delete Selected"})]}),(0,a.jsx)("div",{className:"max-h-64 overflow-y-auto pr-2",children:0===w.length?(0,a.jsx)("div",{className:"py-2 text-muted-foreground text-sm",children:"No documents found."}):0===C.length?(0,a.jsx)("div",{className:"py-2 text-muted-foreground text-sm",children:"No documents match the selected filters."}):(0,a.jsx)("ul",{className:"space-y-2",children:C.map(e=>(0,a.jsx)("li",{className:"border-b pb-2",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4 mt-1",checked:G.has(e.id),onChange:()=>ei(e.id)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"font-medium truncate",children:e.file_name}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.document_type&&(0,a.jsxs)("span",{children:["Type: ",e.document_type," | "]}),e.product_name&&(0,a.jsxs)("span",{children:["Product: ",e.product_name," | "]}),e.product_version&&(0,a.jsxs)("span",{children:["Version: ",e.product_version," | "]}),e.privacy_level&&(0,a.jsxs)("span",{children:["Privacy: ",e.privacy_level," | "]}),e.processed_at&&(0,a.jsxs)("span",{children:["Processed: ",new Date(e.processed_at).toLocaleDateString()," "]})]})]})]})},e.id))})})]})]})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"px-4 pb-2 flex items-center justify-between gap-2",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-muted-foreground",children:"Recent Conversations"}),(0,a.jsxs)(N.z,{size:"sm",variant:"outline",onClick:t,className:"flex items-center gap-1",children:[(0,a.jsx)(L.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-xs",children:"New"})]})]}),(0,a.jsx)("div",{className:"px-2 space-y-1",children:h?(0,a.jsx)("div",{className:"px-1 py-2 text-sm text-muted-foreground",children:"Loading conversations..."}):0===m.length?(0,a.jsx)("div",{className:"px-1 py-2 text-sm text-muted-foreground",children:"No conversations yet. Start a new chat to begin."}):m.map(e=>{var t;let r=null!==(t=e.updatedAt)&&void 0!==t?t:e.createdAt,o=r?new Date(r).toLocaleString():"";return(0,a.jsx)(N.z,{variant:n===e.id?"secondary":"ghost",className:"w-full justify-start text-left h-auto p-3",onClick:()=>s(e.id),children:(0,a.jsxs)("div",{className:"flex items-start gap-2 w-full",children:[(0,a.jsx)(F.Z,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"truncate text-sm",children:e.title}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:o})]}),(0,a.jsxs)("button",{type:"button",className:"ml-2 text-muted-foreground hover:text-destructive transition-colors",onClick:async t=>{if(t.stopPropagation(),window.confirm("Delete this conversation? This action cannot be undone."))try{if(!es)throw Error("Not authenticated");let t=await fetch("/api/conversations/".concat(e.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(es)}});if(!t.ok&&204!==t.status){let e="";try{let s=await t.json();e=(null==s?void 0:s.error)||(null==s?void 0:s.detail)||""}catch(e){}throw Error(e||"Failed to delete conversation (status ".concat(t.status,")"))}null==l||l(e.id),en()}catch(e){console.error("Failed to delete conversation:",e),alert("Failed to delete conversation. Please try again.")}},children:[(0,a.jsx)(I.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Delete conversation"})]})]})},e.id)})})]}),(0,a.jsx)("div",{className:"p-4 border-t",children:(0,a.jsxs)(O,{open:g,onOpenChange:j,children:[(0,a.jsx)(V,{asChild:!0,children:(0,a.jsxs)(N.z,{variant:"ghost",className:"w-full justify-start",children:[(0,a.jsx)(T.Z,{className:"h-4 w-4 mr-2"}),"Settings"]})}),(0,a.jsxs)(U,{className:"sm:max-w-md",children:[(0,a.jsx)(B,{children:(0,a.jsx)(M,{children:"Settings"})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"System Information"}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,a.jsxs)("div",{children:["Documents: ",f.documents]}),(0,a.jsxs)("div",{children:["Chunks: ",f.chunks]}),(0,a.jsx)("div",{children:"RAG System: Production Ready ✅"}),(0,a.jsx)("div",{children:"Load Balancing: 4 Ollama Instances"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Version Information"}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground space-y-1",children:[(0,a.jsx)("div",{children:"Version: 1.0.0"}),(0,a.jsx)("div",{children:"Last Updated: September 24, 2025"}),(0,a.jsx)("div",{children:"Status: Docker Validated"})]})]}),(0,a.jsx)("div",{className:"pt-4 border-t",children:(0,a.jsx)(N.z,{variant:"outline",onClick:()=>j(!1),className:"w-full",children:"Close"})})]})]})]})})]}):(0,a.jsxs)("div",{className:"w-64 bg-muted/30 border-r flex flex-col",children:[(0,a.jsx)("div",{className:"p-4 border-b",children:(0,a.jsxs)(N.z,{variant:"ghost",className:"w-full justify-start",disabled:!0,children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Documents"]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,a.jsx)("div",{className:"px-4 pb-2",children:(0,a.jsx)("h3",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Recent Conversations"})})}),(0,a.jsx)("div",{className:"p-4 border-t",children:(0,a.jsxs)(N.z,{variant:"ghost",className:"w-full justify-start",disabled:!0,children:[(0,a.jsx)(T.Z,{className:"h-4 w-4 mr-2"}),"Settings"]})})]})}var H=s(7818),K=s(407),J=s(401),W=s(519);let $=H.fC,Q=H.xz;H.ZA,H.Uv,H.Tr,H.Ee,r.forwardRef((e,t)=>{let{className:s,inset:r,children:n,...o}=e;return(0,a.jsxs)(H.fF,{ref:t,className:(0,b.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",r&&"pl-8",s),...o,children:[n,(0,a.jsx)(K.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=H.fF.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(H.tu,{ref:t,className:(0,b.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}).displayName=H.tu.displayName;let X=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...n}=e;return(0,a.jsx)(H.Uv,{children:(0,a.jsx)(H.VY,{ref:t,sideOffset:r,className:(0,b.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})})});X.displayName=H.VY.displayName;let ee=r.forwardRef((e,t)=>{let{className:s,inset:r,...n}=e;return(0,a.jsx)(H.ck,{ref:t,className:(0,b.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r&&"pl-8",s),...n})});ee.displayName=H.ck.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,checked:n,...o}=e;return(0,a.jsxs)(H.oC,{ref:t,className:(0,b.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:n,...o,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(H.wU,{children:(0,a.jsx)(J.Z,{className:"h-4 w-4"})})}),r]})}).displayName=H.oC.displayName,r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(H.Rk,{ref:t,className:(0,b.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(H.wU,{children:(0,a.jsx)(W.Z,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=H.Rk.displayName;let et=r.forwardRef((e,t)=>{let{className:s,inset:r,...n}=e;return(0,a.jsx)(H.__,{ref:t,className:(0,b.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...n})});et.displayName=H.__.displayName;let es=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(H.Z0,{ref:t,className:(0,b.cn)("-mx-1 my-1 h-px bg-muted",s),...r})});es.displayName=H.Z0.displayName;var ea=s(2369),er=s(875),en=s(8906),eo=s(6215),ei=s(4401),el=s(4001),ec=s(7692);function ed(e){let{className:t}=e,{user:s,logout:r}=(0,o.a)();if(!s)return null;let n="string"==typeof s.role_name?s.role_name.toLowerCase():null,i="string"==typeof s.role_id?Number.parseInt(s.role_id,10):s.role_id;return(0,a.jsxs)($,{children:[(0,a.jsxs)(Q,{className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors cursor-pointer ".concat(t),children:[(0,a.jsx)(ea.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:s.full_name}),(0,a.jsx)("span",{className:"ml-2 px-2 py-0.5 rounded bg-secondary text-xs uppercase",children:s.role_name||"role "+s.role_id}),(0,a.jsx)(er.Z,{className:"h-4 w-4"})]}),(0,a.jsxs)(X,{align:"end",className:"w-56",children:[(0,a.jsx)(et,{className:"font-normal",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium leading-none",children:s.full_name}),(0,a.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:s.email})]})}),(0,a.jsx)(es,{}),("admin"===n||1===i)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ee,{asChild:!0,children:(0,a.jsxs)(Z.default,{href:"/admin",className:"flex items-center cursor-pointer",children:[(0,a.jsx)(en.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"User / Role Management"})]})}),(0,a.jsx)(ee,{asChild:!0,children:(0,a.jsxs)("a",{href:"http://RNI-LLM-01.lab.sensus.net:3001",target:"_blank",rel:"noopener noreferrer",className:"flex items-center cursor-pointer",children:[(0,a.jsx)(eo.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Grafana Dashboard"})]})}),(0,a.jsx)(ee,{asChild:!0,children:(0,a.jsxs)("a",{href:"http://RNI-LLM-01.lab.sensus.net:9091",target:"_blank",rel:"noopener noreferrer",className:"flex items-center cursor-pointer",children:[(0,a.jsx)(ei.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Prometheus Server"})]})}),(0,a.jsx)(es,{})]}),(0,a.jsx)(ee,{asChild:!0,children:(0,a.jsxs)(Z.default,{href:"/change-password",className:"flex items-center cursor-pointer",children:[(0,a.jsx)(el.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Change Password"})]})}),(0,a.jsx)(es,{}),(0,a.jsxs)(ee,{onClick:r,className:"flex items-center cursor-pointer text-red-600",children:[(0,a.jsx)(ec.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Logout"})]})]})]})}function eu(){let[e,t]=(0,r.useState)(),[s,i]=(0,r.useState)(0),[l,c]=(0,r.useState)(!1),{user:d,logout:u,loading:m}=(0,o.a)(),x=(0,n.useRouter)(),h=null==d?void 0:d.password_change_required,p=null==d?void 0:d.email;return((0,r.useEffect)(()=>{console.log("[HOME] Password change check:",{userEmail:p,passwordChangeRequired:h,redirecting:l}),h&&!l&&(console.log("[HOME] Redirecting to password change page"),c(!0),x.push("/change-password"))},[h,p,x,l]),m)?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}):(null==d?void 0:d.password_change_required)||l?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Redirecting to password change..."})]})}):(0,a.jsxs)("div",{className:"flex h-screen",children:[d&&(0,a.jsx)(G,{onNewChat:()=>{t(void 0)},onSelectConversation:e=>{t(e)},currentConversationId:e,refreshKey:s,onConversationDeleted:s=>{e===s&&t(void 0),i(e=>e+1)}}),(0,a.jsxs)("main",{className:"flex-1 flex flex-col",children:[(0,a.jsxs)("div",{className:"border-b p-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold",children:"Technical Services Assistant"}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:d?"Ask questions about your documents":"Sign in to access the assistant"})]}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:d?(0,a.jsx)(ed,{}):(0,a.jsxs)("div",{className:"flex gap-3 text-sm",children:[(0,a.jsx)(Z.default,{href:"/login",className:"underline",children:"Login"}),(0,a.jsx)(Z.default,{href:"/register",className:"underline",children:"Register"})]})})]}),d?(0,a.jsx)(R,{conversationId:e,onConversationCreated:e=>{t(e),i(e=>e+1)},onConversationActivity:()=>{i(e=>e+1)}}):(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("h2",{className:"text-xl font-medium",children:"Welcome to Technical Service Assistant"}),(0,a.jsx)("p",{className:"text-muted-foreground max-w-md",children:"Authenticate to start secure, role-based retrieval augmented conversations. Your role will control access to private versus public knowledge."}),(0,a.jsxs)("div",{className:"flex gap-4 justify-center",children:[(0,a.jsx)(Z.default,{href:"/login",className:"underline",children:"Login"}),(0,a.jsx)(Z.default,{href:"/register",className:"underline",children:"Register"})]})]})})]})]})}},5974:function(e,t,s){"use strict";s.d(t,{C:function(){return i}});var a=s(7437);s(2265);var r=s(535),n=s(4508);let o=(0,r.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(o({variant:s}),t),...r})}},2869:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var a=s(7437),r=s(2265),n=s(7495),o=s(535),i=s(4508);let l=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:o,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(l({variant:r,size:o,className:s})),ref:t,...d})});c.displayName="Button"},6070:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return o},aY:function(){return d},ll:function(){return l}});var a=s(7437),r=s(2265),n=s(4508);let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...r})});o.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});i.displayName="CardHeader";let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",s),...r})});l.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});c.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...r})});d.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter"}},function(e){e.O(0,[137,648,944,60,971,117,744],function(){return e(e.s=6549)}),_N_E=e.O()}]);