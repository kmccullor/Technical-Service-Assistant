"use strict";(()=>{var e={};e.id=2961,e.ids=[2961],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8678:e=>{e.exports=import("pg")},5287:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.r(t),a.d(t,{originalPathname:()=>f,patchFetch:()=>c,requestAsyncStorage:()=>l,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p});var o=a(9303),r=a(8716),i=a(670),s=a(4072),d=e([s]);s=(d.then?(await d)():d)[0];let u=new o.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/stats/route",pathname:"/api/stats",filename:"route",bundlePath:"app/api/stats/route"},resolvedPagePath:"/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/app/api/stats/route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:p,serverHooks:m}=u,f="/api/stats/route";function c(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:p})}n()}catch(e){n(e)}})},4072:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.r(t),a.d(t,{GET:()=>c});var o=a(7070),r=a(7395),i=a(306),s=a(2315),d=e([r]);async function c(){try{let e=await r.db.select({count:(0,s.i6)`count(*)::int`}).from(i.De),t=await r.db.select({count:(0,s.i6)`count(*)::int`}).from(i.yD);return o.NextResponse.json({documents:e[0].count,chunks:t[0].count})}catch(e){return console.error("Error fetching stats:",e),o.NextResponse.json({error:"Failed to fetch stats"},{status:500})}}r=(d.then?(await d)():d)[0],n()}catch(e){n(e)}})},7395:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{db:()=>u});var o=a(8029),r=a(8678),i=e([r,o]);[r,o]=i.then?(await i)():i;let s=process.env.DATABASE_URL??process.env.POSTGRES_URL??process.env.POSTGRES_CONNECTION_STRING??"postgresql://postgres:postgres@db:5432/vector_db",d=process.env.DATABASE_SSL?.toLowerCase()==="true"||process.env.DATABASE_SSL?.toLowerCase()==="require",c=globalThis.__tsaDbPool||new r.Pool({connectionString:s,ssl:d?{rejectUnauthorized:!1}:void 0}),u=(0,o.tS)(c);n()}catch(e){n(e)}})},306:(e,t,a)=>{a.d(t,{De:()=>l,p5:()=>c,sY:()=>u,yD:()=>p});var n=a(7561),o=a(5961),r=a(2140),i=a(2941),s=a(1575),d=a(8680);let c=(0,n.af)("conversations",{id:(0,o.eP)("id").primaryKey(),title:(0,r.fL)("title").notNull(),userId:(0,i._L)("user_id"),createdAt:(0,s.AB)("created_at",{withTimezone:!0}).defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at",{withTimezone:!0}).defaultNow(),lastReviewedAt:(0,s.AB)("last_reviewed_at",{withTimezone:!0})}),u=(0,n.af)("messages",{id:(0,o.eP)("id").primaryKey(),conversationId:(0,i._L)("conversation_id").notNull().references(()=>c.id,{onDelete:"cascade"}),role:(0,r.fL)("role").notNull(),content:(0,r.fL)("content").notNull(),citations:(0,d.JB)("citations").$type(),createdAt:(0,s.AB)("created_at",{withTimezone:!0}).defaultNow().notNull()}),l=(0,n.af)("documents",{id:(0,o.eP)("id").primaryKey(),fileName:(0,r.fL)("file_name").notNull(),title:(0,r.fL)("title").notNull(),description:(0,r.fL)("description"),fileHash:(0,r.fL)("file_hash"),fileSize:(0,i._L)("file_size"),mimeType:(0,r.fL)("mime_type"),documentType:(0,r.fL)("document_type"),productName:(0,r.fL)("product_name"),productVersion:(0,r.fL)("product_version"),privacyLevel:(0,r.fL)("privacy_level"),processedAt:(0,s.AB)("processed_at",{withTimezone:!0}),createdAt:(0,s.AB)("created_at",{withTimezone:!0}).defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at",{withTimezone:!0}).defaultNow().notNull()}),p=(0,n.af)("document_chunks",{id:(0,o.eP)("id").primaryKey(),documentId:(0,i._L)("document_id").notNull().references(()=>l.id,{onDelete:"cascade"}),chunkIndex:(0,i._L)("chunk_index"),pageNumber:(0,i._L)("page_number"),chunkType:(0,r.fL)("chunk_type"),content:(0,r.fL)("content").notNull(),contentHash:(0,r.fL)("content_hash"),contentLength:(0,i._L)("content_length").default(0).notNull(),metadata:(0,d.JB)("metadata").$type().default({}),embedding:(0,d.JB)("embedding").$type(),createdAt:(0,s.AB)("created_at",{withTimezone:!0}).defaultNow().notNull(),updatedAt:(0,s.AB)("updated_at",{withTimezone:!0}).defaultNow()})}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),n=t.X(0,[8948,5972,8029],()=>a(5287));module.exports=n})();