"use strict";(()=>{var e={};e.id=961,e.ids=[961],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8678:e=>{e.exports=import("pg")},5287:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.r(t),a.d(t,{originalPathname:()=>f,patchFetch:()=>d,requestAsyncStorage:()=>l,routeModule:()=>u,serverHooks:()=>p,staticGenerationAsyncStorage:()=>m});var o=a(3278),s=a(5002),r=a(4877),i=a(9073),c=e([i]);i=(c.then?(await c)():c)[0];let u=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/stats/route",pathname:"/api/stats",filename:"route",bundlePath:"app/api/stats/route"},resolvedPagePath:"/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/app/api/stats/route.ts",nextConfigOutput:"standalone",userland:i}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:p}=u,f="/api/stats/route";function d(){return(0,r.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:m})}n()}catch(e){n(e)}})},9073:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.r(t),a.d(t,{GET:()=>d});var o=a(1309),s=a(8420),r=a(7382),i=a(4214),c=e([s]);async function d(){try{let e=await s.db.select({count:(0,i.i6)`count(*)::int`}).from(r.documents),t=await s.db.select({count:(0,i.i6)`count(*)::int`}).from(r.documentChunks);return o.NextResponse.json({documents:e[0].count,chunks:t[0].count})}catch(e){return console.error("Error fetching stats:",e),o.NextResponse.json({error:"Failed to fetch stats"},{status:500})}}s=(c.then?(await c)():c)[0],n()}catch(e){n(e)}})},8420:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{db:()=>m});var o=a(2163),s=a(8678),r=a(7382),i=e([s,o]);[s,o]=i.then?(await i)():i;let c="postgresql://postgres:postgres@pgvector:5432/vector_db";if(console.log("Database configuration:",{DATABASE_URL:c?"set":"not set",DATABASE_URL_value:c,NODE_ENV:"production"}),!c)throw Error("DATABASE_URL environment variable is required");let d=new URL(c),u={host:d.hostname,port:parseInt(d.port)||5432,database:d.pathname.slice(1),user:d.username,password:d.password,ssl:!1,max:20,idleTimeoutMillis:3e4,connectionTimeoutMillis:2e3};console.log("Raw URL parts:",{href:d.href,hostname:d.hostname,port:d.port,pathname:d.pathname,username:d.username}),console.log("Parsed connection config:",{host:u.host,port:u.port,database:u.database,user:u.user});let l=new s.Pool(u);l.on("error",e=>{console.error("PostgreSQL pool error:",e)});let m=(0,o.tS)(l,{schema:r});n()}catch(e){n(e)}})},7382:(e,t,a)=>{a.r(t),a.d(t,{conversations:()=>_,conversationsRelations:()=>v,documentChunks:()=>h,documentChunksRelations:()=>y,documents:()=>f,documentsRelations:()=>L,messages:()=>g,messagesRelations:()=>b});var n=a(6620),o=a(9894),s=a(9411),r=a(7681),i=a(4717),c=a(4006),d=a(5671),u=a(380),l=a(3204),m=a(4211),p=a(4497);let f=(0,n.af)("documents",{id:(0,o.c0)("id",{mode:"number"}).primaryKey(),fileName:(0,s.fL)("file_name").notNull(),originalPath:(0,s.fL)("original_path"),fileHash:(0,s.fL)("file_hash").notNull().unique(),fileSize:(0,r.Kv)("file_size",{mode:"number"}),mimeType:(0,s.fL)("mime_type"),title:(0,s.fL)("title"),version:(0,s.fL)("version"),docNumber:(0,s.fL)("doc_number"),gaDate:(0,i.hT)("ga_date"),publisher:(0,s.fL)("publisher"),copyrightYear:(0,c._L)("copyright_year"),productFamily:(0,s.fL)("product_family").array(),productName:(0,s.fL)("product_name"),productVersion:(0,s.fL)("product_version"),documentType:(0,s.fL)("document_type"),documentCategory:(0,s.fL)("document_category"),serviceLines:(0,s.fL)("service_lines").array(),audiences:(0,s.fL)("audiences").array(),privacyLevel:(0,s.fL)("privacy_level").default("public"),securityClassification:(0,s.fL)("security_classification"),classificationConfidence:(0,d.kw)("classification_confidence"),classificationMethod:(0,s.fL)("classification_method"),processingStatus:(0,s.fL)("processing_status").default("pending"),processedAt:(0,u.AB)("processed_at",{withTimezone:!0}),metadata:(0,l.JB)("metadata").default("{}"),createdAt:(0,u.AB)("created_at",{withTimezone:!0}).defaultNow(),updatedAt:(0,u.AB)("updated_at",{withTimezone:!0}).defaultNow()}),h=(0,n.af)("document_chunks",{id:(0,o.c0)("id",{mode:"number"}).primaryKey(),documentId:(0,r.Kv)("document_id",{mode:"number"}).references(()=>f.id,{onDelete:"cascade"}).notNull(),chunkIndex:(0,c._L)("chunk_index").notNull(),pageNumber:(0,c._L)("page_number"),sectionTitle:(0,s.fL)("section_title"),chunkType:(0,s.fL)("chunk_type").default("text"),content:(0,s.fL)("content").notNull(),contentHash:(0,s.fL)("content_hash").notNull(),contentLength:(0,c._L)("content_length"),embedding:(0,m.xr)("embedding",{dimensions:768}),language:(0,s.fL)("language").default("en"),tokens:(0,c._L)("tokens"),metadata:(0,l.JB)("metadata").default("{}"),contentTsvector:(0,s.fL)("content_tsvector"),createdAt:(0,u.AB)("created_at",{withTimezone:!0}).defaultNow()}),_=(0,n.af)("conversations",{id:(0,o.c0)("id",{mode:"number"}).primaryKey(),title:(0,s.fL)("title").notNull(),createdAt:(0,u.AB)("created_at",{withTimezone:!0}).defaultNow()}),g=(0,n.af)("messages",{id:(0,o.c0)("id",{mode:"number"}).primaryKey(),conversationId:(0,r.Kv)("conversation_id",{mode:"number"}).references(()=>_.id,{onDelete:"cascade"}).notNull(),role:(0,s.fL)("role",{enum:["user","assistant","system"]}).notNull(),content:(0,s.fL)("content").notNull(),citations:(0,l.JB)("citations"),createdAt:(0,u.AB)("created_at",{withTimezone:!0}).defaultNow()}),L=(0,p.lE)(f,({many:e})=>({chunks:e(h)})),y=(0,p.lE)(h,({one:e})=>({document:e(f,{fields:[h.documentId],references:[f.id]})})),v=(0,p.lE)(_,({many:e})=>({messages:e(g)})),b=(0,p.lE)(g,({one:e})=>({conversation:e(_,{fields:[g.conversationId],references:[_.id]})}))}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),n=t.X(0,[379,833,163],()=>a(5287));module.exports=n})();