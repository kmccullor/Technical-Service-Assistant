"use strict";(()=>{var e={};e.id=678,e.ids=[678],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2048:e=>{e.exports=require("fs")},629:e=>{e.exports=require("fs/promises")},5315:e=>{e.exports=require("path")},5647:(e,s,r)=>{r.r(s),r.d(s,{originalPathname:()=>v,patchFetch:()=>h,requestAsyncStorage:()=>j,routeModule:()=>g,serverHooks:()=>w,staticGenerationAsyncStorage:()=>y});var t={};r.r(t),r.d(t,{DELETE:()=>x,POST:()=>f});var o=r(3278),i=r(5002),a=r(4877),n=r(1309),p=r(629),u=r(5315);let l=require("crypto");var c=r(2048);let d=[".txt",".log",".csv",".json",".sql",".pdf",".xml",".conf",".config",".ini",".properties",".out",".err",".trace",".dump",".png",".jpg",".jpeg",".gif",".bmp",".tiff",".webp"],m=(0,u.join)(process.cwd(),"temp-uploads");async function f(e){try{(0,c.existsSync)(m)||await (0,p.mkdir)(m,{recursive:!0});let s=(await e.formData()).get("file");if(!s)return n.NextResponse.json({success:!1,error:"No file provided"},{status:400});if(s.size>10485760)return n.NextResponse.json({success:!1,error:"File size exceeds maximum limit of 10MB"},{status:400});let r=s.name.toLowerCase().substring(s.name.lastIndexOf("."));if(!d.includes(r))return n.NextResponse.json({success:!1,error:`File type not supported. Allowed types: ${d.join(", ")}`},{status:400});let t=(0,l.randomUUID)(),o=(0,u.join)(m,t);await (0,p.mkdir)(o,{recursive:!0});let i=await s.arrayBuffer(),a=Buffer.from(i),f=s.name.replace(/[^a-zA-Z0-9.-]/g,"_"),x=(0,u.join)(o,f);await (0,p.writeFile)(x,a);let g={originalName:s.name,safeFileName:f,size:s.size,type:s.type,extension:r,uploadTime:new Date().toISOString(),sessionId:t};return await (0,p.writeFile)((0,u.join)(o,"metadata.json"),JSON.stringify(g,null,2)),console.log(`Temporary file uploaded: ${s.name} (${s.size} bytes) - Session: ${t}`),n.NextResponse.json({success:!0,sessionId:t,fileName:s.name,fileSize:s.size,message:"File uploaded successfully for temporary analysis"})}catch(e){return console.error("Upload error:",e),n.NextResponse.json({success:!1,error:"Failed to upload file"},{status:500})}}async function x(e){try{let{searchParams:s}=new URL(e.url),t=s.get("sessionId");if(!t)return n.NextResponse.json({error:"Session ID required"},{status:400});let o=(0,u.join)(m,t);if((0,c.existsSync)(o)){let{rmdir:e}=await Promise.resolve().then(r.t.bind(r,629,23));await e(o,{recursive:!0}),console.log(`Cleaned up temporary session: ${t}`)}return n.NextResponse.json({success:!0,message:"Session cleaned up"})}catch(e){return console.error("Cleanup error:",e),n.NextResponse.json({error:"Failed to cleanup session"},{status:500})}}let g=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/temp-upload/route",pathname:"/api/temp-upload",filename:"route",bundlePath:"app/api/temp-upload/route"},resolvedPagePath:"/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/app/api/temp-upload/route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:j,staticGenerationAsyncStorage:y,serverHooks:w}=g,v="/api/temp-upload/route";function h(){return(0,a.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:y})}}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[9379,4833],()=>r(5647));module.exports=t})();