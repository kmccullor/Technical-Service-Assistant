(()=>{var e={};e.id=6973,e.ids=[6973],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7377:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>i,routeModule:()=>m,tree:()=>d}),a(834),a(356),a(5866);var r=a(3191),t=a(8716),o=a(7922),n=a.n(o),l=a(5231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);a.d(s,c);let d=["",{children:["change-password",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,834)),"/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/app/change-password/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,356)),"/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],i=["/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/app/change-password/page.tsx"],u="/change-password/page",p={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/change-password/page",pathname:"/change-password",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5504:(e,s,a)=>{Promise.resolve().then(a.bind(a,4604))},4604:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>d});var r=a(326),t=a(7577),o=a(5047),n=a(4690),l=a(772),c=a(2643);function d(){let{user:e,logout:s,refresh:a,accessToken:d}=(0,n.a)(),i=(0,o.useRouter)(),[u,p]=(0,t.useState)(""),[m,g]=(0,t.useState)(""),[h,x]=(0,t.useState)(""),[w,f]=(0,t.useState)(!1),[P,b]=(0,t.useState)(null),[j,v]=(0,t.useState)(null),[y,N]=(0,t.useState)(!1),[_,C]=(0,t.useState)(!1),A=e=>e.length<8?"Password must be at least 8 characters long":/[A-Z]/.test(e)?/[a-z]/.test(e)?/\d/.test(e)?/[!@#$%^&*(),.?":{}|<>]/.test(e)?null:"Password must contain at least one special character":"Password must contain at least one digit":"Password must contain at least one lowercase letter":"Password must contain at least one uppercase letter",S=async e=>{e.preventDefault(),console.log("[CHANGE_PWD] Form submitted, isForced:",y),b(null),v(null);let r=A(m);if(r){b(r);return}if(m!==h){b("New password and confirmation do not match");return}if(!y&&!u){b("Current password is required");return}f(!0);try{let e=y?"/api/auth/force-change-password":"/api/auth/change-password",r=y?{new_password:m,confirm_password:h}:{current_password:u,new_password:m,confirm_password:h};console.log("[CHANGE_PWD] Sending password change request to:",e),console.log("[CHANGE_PWD] Payload type:",y?"force-change":"normal-change");let t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",...d&&{Authorization:`Bearer ${d}`}},body:JSON.stringify(r)});console.log("[CHANGE_PWD] Password change response status:",t.status);let o=await t.json();if(t.ok){console.log("[CHANGE_PWD] Password change successful"),v("Password changed successfully. Redirecting to login...");try{console.log("[CHANGE_PWD] Refreshing user profile before logout"),await a()}catch(e){console.warn("[CHANGE_PWD] Failed to refresh profile after password change",e)}console.log("[CHANGE_PWD] Logging user out after password change"),C(!0),s(),i.replace("/login")}else b(o.detail||"Failed to change password")}catch(e){b("Network error. Please try again.")}finally{f(!1)}};return!e&&_?null:r.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,r.jsxs)(c.Zb,{className:"p-8 w-full max-w-md space-y-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-2xl font-semibold mb-2",children:y?"Change Your Password":"Change Password"}),y?r.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"You must change your password before continuing. Please choose a strong password."}):r.jsx("p",{className:"text-sm text-muted-foreground",children:"Update your account password"})]}),P&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:P}),j&&r.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:j}),(0,r.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[!y&&(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",htmlFor:"current-password",children:"Current Password"}),r.jsx("input",{id:"current-password",type:"password",value:u,onChange:e=>p(e.target.value),className:"w-full border rounded px-3 py-2 text-sm bg-background",placeholder:"Enter current password",required:!y})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",htmlFor:"new-password",children:"New Password"}),r.jsx("input",{id:"new-password",type:"password",value:m,onChange:e=>g(e.target.value),className:"w-full border rounded px-3 py-2 text-sm bg-background",placeholder:"Enter new password",required:!0}),r.jsx("div",{className:"text-xs text-muted-foreground",children:"Password must contain at least 8 characters, including uppercase, lowercase, digit, and special character"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-medium",htmlFor:"confirm-password",children:"Confirm New Password"}),r.jsx("input",{id:"confirm-password",type:"password",value:h,onChange:e=>x(e.target.value),className:"w-full border rounded px-3 py-2 text-sm bg-background",placeholder:"Confirm new password",required:!0})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[r.jsx(l.z,{type:"submit",disabled:w,className:"flex-1",children:w?"Changing...":"Change Password"}),!y&&r.jsx(l.z,{type:"button",variant:"outline",onClick:()=>i.back(),disabled:w,children:"Cancel"})]})]}),y&&r.jsx("div",{className:"pt-4 border-t",children:r.jsx(l.z,{variant:"outline",onClick:()=>{s(),i.push("/login")},className:"w-full",children:"Logout Instead"})})]})})}},5047:(e,s,a)=>{"use strict";var r=a(7389);a.o(r,"useRouter")&&a.d(s,{useRouter:function(){return r.useRouter}})},834:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>r});let r=(0,a(8570).createProxy)(String.raw`/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/app/change-password/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),r=s.X(0,[8948,2892,325,8169],()=>a(7377));module.exports=r})();