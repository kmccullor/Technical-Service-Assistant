(()=>{var e={};e.id=1817,e.ids=[1817],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7416:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),t(3932),t(356),t(5866);var r=t(3191),a=t(8716),l=t(7922),n=t.n(l),i=t(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(s,o);let c=["",{children:["temp-analysis",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3932)),"/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/app/temp-analysis/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,356)),"/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/app/temp-analysis/page.tsx"],u="/temp-analysis/page",h={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/temp-analysis/page",pathname:"/temp-analysis",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},2303:(e,s,t)=>{Promise.resolve().then(t.bind(t,4690))},7719:(e,s,t)=>{Promise.resolve().then(t.bind(t,9310))},3649:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},9310:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var r=t(326),a=t(7577),l=t(7506),n=t(3685),i=t(361),o=t(4019);let c=(0,t(2881).Z)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);var d=t(1291),u=t(4690);let h=[".txt",".log",".csv",".json",".sql",".pdf",".xml",".conf",".config",".ini",".properties",".out",".err",".trace",".dump"];function m({onFileUploaded:e,onAnalysisResult:s}){let[t,m]=(0,a.useState)(!1),[p,x]=(0,a.useState)(null),[g,f]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!1),[b,v]=(0,a.useState)(null),[k,N]=(0,a.useState)(""),[w,A]=(0,a.useState)(null),T=(0,a.useRef)(null),{accessToken:_}=(0,u.a)(),P=(0,a.useCallback)(e=>{if(e.size>10485760)return"File size exceeds 10MB limit";let s=e.name.toLowerCase().substring(e.name.lastIndexOf("."));return h.includes(s)?null:`File type not supported. Allowed: ${h.join(", ")}`},[]),S=(0,a.useCallback)(async s=>{let t=P(s);if(t){v(t);return}f(!0),v(null);try{let t=new FormData;t.append("file",s);let r=await fetch("/api/temp-upload",{method:"POST",headers:_?{Authorization:`Bearer ${_}`}:void 0,body:t}),a=await r.json();if(!a.success)throw Error(a.error||"Upload failed");let l={sessionId:a.sessionId,fileName:a.fileName,fileSize:a.fileSize,uploadTime:new Date().toISOString()};x(l),e?.(l)}catch(e){console.error("Upload error:",e),v(e instanceof Error?e.message:"Upload failed")}finally{f(!1)}},[_,e,P]),C=(0,a.useCallback)(e=>{e&&0!==e.length&&S(e[0])},[S]),U=(0,a.useCallback)(e=>{e.preventDefault(),m(!0)},[]),q=(0,a.useCallback)(e=>{e.preventDefault(),m(!1)},[]),M=(0,a.useCallback)(e=>{e.preventDefault(),m(!1),C(e.dataTransfer.files)},[C]),H=async()=>{if(p&&k.trim()){j(!0),v(null);try{let e=await fetch("/api/temp-analyze",{method:"POST",headers:{"Content-Type":"application/json",..._?{Authorization:`Bearer ${_}`}:{}},body:JSON.stringify({sessionId:p.sessionId,query:k.trim(),maxResults:5})}),t=await e.json();if(e.ok)A(t),s?.(t);else throw Error(t.error||"Analysis failed")}catch(e){console.error("Analysis error:",e),v(e instanceof Error?e.message:"Analysis failed")}finally{j(!1)}}};return(0,r.jsxs)("div",{className:"w-full max-w-2xl mx-auto p-6 space-y-6",children:[!p&&(0,r.jsxs)("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${t?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:U,onDragLeave:q,onDrop:M,children:[r.jsx("input",{ref:T,type:"file",className:"hidden",accept:h.join(","),onChange:e=>C(e.target.files)}),g?(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx(l.Z,{className:"h-12 w-12 mx-auto text-blue-500 animate-spin"}),r.jsx("p",{className:"text-gray-600",children:"Uploading file..."})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx(n.Z,{className:"h-12 w-12 mx-auto text-gray-400"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-lg font-medium text-gray-900",children:"Upload Document for Analysis"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Drag and drop a file here, or"," ",r.jsx("button",{onClick:()=>T.current?.click(),className:"text-blue-500 hover:text-blue-600 font-medium",children:"browse to upload"})]})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400 space-y-1",children:[(0,r.jsxs)("p",{children:["Supported: ",h.slice(0,6).join(", "),"..."]}),r.jsx("p",{children:"Max size: 10MB"})]})]})]}),p&&r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[r.jsx(i.Z,{className:"h-5 w-5 text-green-500"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-green-900",children:p.fileName}),(0,r.jsxs)("p",{className:"text-sm text-green-600",children:[(e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(1))+" "+["Bytes","KB","MB"][s]})(p.fileSize)," • Uploaded successfully"]})]})]}),r.jsx("button",{onClick:()=>{x(null),N(""),A(null),v(null),T.current&&(T.current.value="")},className:"text-gray-400 hover:text-gray-600",children:r.jsx(o.Z,{className:"h-5 w-5"})})]})}),p&&r.jsx("div",{className:"space-y-4",children:(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ask a question about the document:"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[r.jsx("input",{type:"text",value:k,onChange:e=>N(e.target.value),placeholder:"e.g., What errors are reported in this log?",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyDown:e=>"Enter"===e.key&&H()}),(0,r.jsxs)("button",{onClick:H,disabled:!k.trim()||y,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[y?r.jsx(l.Z,{className:"h-4 w-4 animate-spin"}):r.jsx(c,{className:"h-4 w-4"}),r.jsx("span",{children:y?"Analyzing...":"Analyze"})]})]})]})}),b&&(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-3",children:[r.jsx(d.Z,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-red-900",children:"Error"}),r.jsx("p",{className:"text-sm text-red-600",children:b})]})]}),w&&(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"border-b pb-3",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Analysis Results"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Confidence: ",(100*w.confidence).toFixed(1),"%"]})]}),r.jsx("div",{className:"prose prose-sm max-w-none",children:(0,r.jsxs)("div",{className:"bg-gray-50 rounded p-4",children:[r.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Technical Analysis:"}),r.jsx("div",{className:"whitespace-pre-wrap text-gray-800",children:w.response})]})}),w.results&&w.results.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("h4",{className:"font-medium text-gray-700",children:"Relevant Sections:"}),w.results.map((e,s)=>(0,r.jsxs)("div",{className:"bg-gray-50 rounded p-3 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,r.jsxs)("span",{className:"font-medium text-gray-600",children:["Section ",e.rank]}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[(100*e.similarity).toFixed(1),"% match"]})]}),r.jsx("p",{className:"text-gray-700",children:e.content})]},s))]})]})]})}function p(){return r.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Document Analysis Tool"}),r.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Upload logs, configuration files, query results, or technical documents for immediate AI-powered analysis"})]}),r.jsx("div",{className:"bg-white rounded-lg shadow-lg p-8",children:r.jsx(m,{onFileUploaded:e=>{console.log("File uploaded:",e)},onAnalysisResult:e=>{console.log("Analysis result:",e)}})}),(0,r.jsxs)("div",{className:"mt-8 bg-blue-50 rounded-lg p-6",children:[r.jsx("h2",{className:"text-lg font-medium text-blue-900 mb-3",children:"Perfect for Troubleshooting"}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-blue-800",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium mb-2",children:"Supported File Types:"}),(0,r.jsxs)("ul",{className:"space-y-1",children:[r.jsx("li",{children:"• Log files (.log, .out, .err, .trace)"}),r.jsx("li",{children:"• Configuration files (.conf, .config, .ini)"}),r.jsx("li",{children:"• Query results (.csv, .json, .sql)"}),r.jsx("li",{children:"• Technical documents (.pdf, .txt)"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-medium mb-2",children:"Use Cases:"}),(0,r.jsxs)("ul",{className:"space-y-1",children:[r.jsx("li",{children:"• Analyze error logs for root causes"}),r.jsx("li",{children:"• Review configuration settings"}),r.jsx("li",{children:"• Examine database query results"}),r.jsx("li",{children:"• Extract insights from technical docs"})]})]})]}),(0,r.jsxs)("div",{className:"mt-4 p-3 bg-blue-100 rounded text-sm text-blue-800",children:[r.jsx("strong",{children:"Privacy Note:"})," Files are processed temporarily and automatically deleted after 2 hours. No data is permanently stored."]})]})]})})}},2881:(e,s,t)=>{"use strict";t.d(s,{Z:()=>o});var r=t(7577);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=(...e)=>e.filter((e,s,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===s).join(" ").trim();var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)(({color:e="currentColor",size:s=24,strokeWidth:t=2,absoluteStrokeWidth:a,className:i="",children:o,iconNode:c,...d},u)=>(0,r.createElement)("svg",{ref:u,...n,width:s,height:s,stroke:e,strokeWidth:a?24*Number(t)/Number(s):t,className:l("lucide",i),...d},[...c.map(([e,s])=>(0,r.createElement)(e,s)),...Array.isArray(o)?o:[o]])),o=(e,s)=>{let t=(0,r.forwardRef)(({className:t,...n},o)=>(0,r.createElement)(i,{ref:o,iconNode:s,className:l(`lucide-${a(e)}`,t),...n}));return t.displayName=`${e}`,t}},1291:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(2881).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},361:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(2881).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},7506:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(2881).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3685:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(2881).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},4019:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(2881).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4690:(e,s,t)=>{"use strict";t.d(s,{AuthProvider:()=>o,a:()=>c});var r=t(326),a=t(7577);let l=(0,a.createContext)(void 0),n="tsa_auth_v1";function i(e){try{localStorage.setItem(n,JSON.stringify(e))}catch(e){}}let o=({children:e})=>{let[s,t]=(0,a.useState)({user:null,accessToken:null,refreshToken:null,expiresAt:null,loading:!0,error:null}),o=e=>t(s=>({...s,...e})),c=e=>e;(0,a.useEffect)(()=>{let e=!1;return(async()=>{console.log("[AUTH] Initializing auth context");let s=function(){try{let e=localStorage.getItem(n);if(!e)return null;return JSON.parse(e)}catch(e){return null}}();if(console.log("[AUTH] Persisted state:",s?"Found tokens":"No tokens"),!s?.accessToken){console.log("[AUTH] No access token found, setting loading false"),e||o({loading:!1});return}console.log("[AUTH] Found access token, loading user profile"),o({...s,loading:!0});try{let s=await fetch(c("/api/auth/health")).catch(()=>null);if(!s||!s.ok&&404!==s.status){e||o({loading:!1,error:"Auth service unavailable"});return}}catch(s){e||o({loading:!1,error:"Auth service unavailable"});return}try{console.log("[AUTH] Fetching user profile from /api/auth/me");let t=await fetch(c("/api/auth/me"),{headers:{Authorization:`Bearer ${s.accessToken}`}});if(console.log("[AUTH] Profile fetch response status:",t.status),t.ok){let s=await t.json();console.log("[AUTH] Profile loaded:",{id:s.id,email:s.email,password_change_required:s.password_change_required}),e||o({user:s,loading:!1})}else e||(o({loading:!1,accessToken:null,refreshToken:null,user:null}),i({}))}catch(s){e||o({loading:!1})}})(),()=>{e=!0}},[]);let d=(0,a.useCallback)(async(e,s)=>{console.log("[AUTH] Login attempt for:",e),o({loading:!0,error:null});try{console.log("[AUTH] Sending login request to:",c("/api/auth/login"));let t=await fetch(c("/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:s})});if(console.log("[AUTH] Login response status:",t.status),!t.ok){let e="Login failed";try{let s=await t.json();s&&"string"==typeof s.detail&&(e=s.detail)}catch(e){}return o({loading:!1,error:e}),!1}let r=null;try{r=await t.json()}catch(e){return o({loading:!1,error:"Malformed server response"}),!1}if(console.log("[AUTH] Login response data:",{hasAccessToken:!!r.access_token,hasRefreshToken:!!r.refresh_token,hasUser:!!r.user,userPasswordChangeRequired:r.user?.password_change_required}),!r||"object"!=typeof r||!r.access_token||!r.refresh_token||"number"!=typeof r.expires_in||!r.user)return console.log("[AUTH] Invalid login response data"),o({loading:!1,error:"Unexpected auth response"}),!1;let a=Number.isFinite(r.expires_in)?r.expires_in:0,l=Date.now()+Math.max(0,1e3*a-5e3),n={accessToken:r.access_token,refreshToken:r.refresh_token,expiresAt:l,user:r.user};return console.log("[AUTH] Login successful, setting user state:",{email:r.user.email,password_change_required:r.user.password_change_required}),o({...n,loading:!1}),i(n),!0}catch(e){return o({loading:!1,error:"Network error"}),!1}},[]),u=(0,a.useCallback)(async e=>{o({loading:!0,error:null});try{let s=await fetch(c("/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,role_id:e.role_id||2})});if(!s.ok){let e=(await s.json().catch(()=>({}))).detail||"Registration failed";return o({loading:!1,error:e}),!1}return o({loading:!1}),!0}catch(e){return o({loading:!1,error:"Network error"}),!1}},[]),h=(0,a.useCallback)(()=>{o({user:null,accessToken:null,refreshToken:null,expiresAt:null}),i({})},[]);(0,a.useEffect)(()=>{if(globalThis._tsaFetchWrapped)return;let e=fetch;globalThis._tsaFetchWrapped=!0,globalThis.fetch=async(...s)=>{let t=await e(...s);if(401===t.status){let e="string"==typeof s[0]?s[0]:s[0].url;e.includes("/api/auth/login")||e.includes("/api/auth/register")||h()}return t}},[h]);let m=(0,a.useCallback)(async()=>{if(console.log("[AUTH] Refresh called"),!s.refreshToken){console.log("[AUTH] No refresh token available");return}if(m._inFlight){console.log("[AUTH] Refresh already in flight");return}console.log("[AUTH] Starting token refresh"),m._inFlight=!0;try{let e=await fetch(c("/api/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:s.refreshToken})});if(console.log("[AUTH] Refresh response status:",e.status),!e.ok)return console.log("[AUTH] Refresh failed, logging out"),h();let t=await e.json();console.log("[AUTH] Refresh successful, updated user:",{email:t.user?.email,password_change_required:t.user?.password_change_required});let r=1e3*t.expires_in,a=Date.now()+r-Math.min(5e3,Math.max(1e3,.08*r)),l={accessToken:t.access_token,expiresAt:a,user:t.user};o(l),i({...l,refreshToken:s.refreshToken})}catch(e){h()}finally{m._inFlight=!1}},[s.refreshToken,h]);(0,a.useEffect)(()=>{if(!s.expiresAt)return;let e=s.expiresAt-Date.now();if(e<=0){m();return}let t=e-.12*e;t<1500&&(t=Math.min(Math.max(e-500,0),1500));let r=setTimeout(()=>m(),t);return()=>clearTimeout(r)},[s.expiresAt,m]);let p={...s,login:d,register:u,logout:h,refresh:m};return r.jsx(l.Provider,{value:p,children:e})};function c(){let e=(0,a.useContext)(l);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},356:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i,metadata:()=>n});var r=t(9510);t(7272);var a=t(8570);let l=(0,a.createProxy)(String.raw`/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/src/context/AuthContext.tsx#AuthProvider`);(0,a.createProxy)(String.raw`/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/src/context/AuthContext.tsx#useAuth`);let n={title:"Technical Services Assistant",description:"Intelligent document search and chat with RAG capabilities"};function i({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{className:"font-sans antialiased",children:r.jsx(l,{children:r.jsx("div",{className:"min-h-screen bg-background",children:e})})})})}},3932:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(8570).createProxy)(String.raw`/home/kmccullor/Projects/Technical-Service-Assistant/next-rag-app/app/temp-analysis/page.tsx#default`)},7272:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[8948,4471],()=>t(7416));module.exports=r})();