# Add daily morning checklist to Makefile
daily-checklist:
	@echo "🌅 Running Daily Morning Checklist..."
	@./scripts/daily_morning_checklist.sh

# Quick health check (subset of full checklist)
health-check:
	@echo "🏥 Quick Health Check..."
	@docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"
	@echo "\n=== Testing Core Endpoints ==="
	@curl -f -s http://localhost:8008/health && echo "✅ Reranker OK" || echo "❌ Reranker FAIL"
	@curl -f -s http://localhost:11434/api/tags > /dev/null && echo "✅ Ollama-1 OK" || echo "❌ Ollama-1 FAIL"
	@curl -f -s http://localhost:8080 > /dev/null && echo "✅ Frontend OK" || echo "❌ Frontend FAIL"
	@echo "\n=== System Resources ==="
	@df -h . | tail -1
	@free -h | head -2

# Show recent logs with errors
check-logs:
	@echo "🔍 Recent Error Logs (Last 24 Hours)..."
	@echo "=== PDF Processor ==="
	@docker logs --since="24h" pdf_processor 2>/dev/null | grep -E "(ERROR|FATAL|Exception)" | tail -5 || echo "No critical errors"
	@echo "=== Reranker ==="  
	@docker logs --since="24h" reranker 2>/dev/null | grep -E "(ERROR|FATAL|Exception)" | tail -5 || echo "No critical errors"
	@echo "=== Database ==="
	@docker logs --since="24h" pgvector 2>/dev/null | grep -E "(ERROR|FATAL|Exception)" | tail -5 || echo "No critical errors"

# Morning routine - run checklist and show status
morning:
	@echo "☀️ Good Morning! Starting system check..."
	@make daily-checklist || (echo "\n❌ Critical issues found! Check the log file." && exit 1)
	@echo "\n🚀 System ready for development work!"